{
  "security" => {
    "security-domain" => {
      "lightblue-cert" => {
        "authentication" => {
          "classic" => {
            "login-module" => {
              "CertLdapLoginModule" => {
                "code" => "com.redhat.lightblue.rest.auth.jboss.CertLdapLoginModule",
                "flag" => "required",
                "module-options" => {
                  "password-stacking" => "useFirstPass",
                  "securityDomain" => "lightblue-cert",
                  "verifier" => "org.jboss.security.auth.certs.AnyCertVerifier",
                  "rolesProperties" => "deleted",
                  "authRoleName" => "authenticated",
                  "ldapServer" => "<%= @ldap_server %>",
                  "port" => "<%= @ldap_port %>",
                  "searchBase" => "<%= @ldap_search_base %>",
                  "bindDn" => "<%= @ldap_username %>",
                  "bindPassword" => "<%= @ldap_password %>",
                  "useSSL" => "<%= @ldap_use_tls %>",
                  "poolSize" => "<%= @ldap_pool_size %>",
                  "trustStore" => expression "<%= @truststore_url %>",
                  "trustStorePassword" => "<%= @truststore_password %>",
                  "environment" => "<%= @environment %>",
                  "debug" => "<%= @debug %>",
                  "keepAlive" => "<%= @keepAlive %>",
                  "connectionTimeoutMS" => "<%= @connectionTimeoutMS %>",
                  "responseTimeoutMS" => "<%= @responseTimeoutMS %>",
                  "poolMaxConnectionAgeMS" => "<%= @poolMaxConnectionAgeMS %>",
                }
              }
            }
          }
        },
        "jsse" => {
          "classic" => {
             "client-auth" => true,
             "keystore" => {
                        "password" => "<%= @keystore_password %>",
                        "url" => expression "file://<%= @keystore_url %>"
                    },
             "truststore" => {
                        "password" => "<%= @truststore_password %>",
                        "url" => expression "file://<%= @truststore_url %>"
                    }
            }
         }
      }
    }
  }
}
