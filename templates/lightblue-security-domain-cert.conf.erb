{
  "security" => {
    "security-domain" => {
      "lightblue-cert" => {
        "authentication" => {
          "classic" => {
            "login-module" => {
              "CertLdapLoginModule" => {
                "code" => "com.redhat.lightblue.rest.auth.jboss.CertLdapLoginModule",
                "flag" => "required",
                "module-options" => {
                  "password-stacking" => "useFirstPass",
                  "securityDomain" => "lightblue-cert",
                  "verifier" => "org.jboss.security.auth.certs.AnyCertVerifier",
                  "rolesProperties" => expression "file://${jboss.server.config.dir}/roles.properties",
                  "authRoleName" => "authenticated",
                  "ldapServer" => "<%= ldap_ad_server %>",
                  "searchBase" => "<%= ldap_search_base %>",
                  "bindDn" => "<%= ldap_username %>",
                  "bindPassword" => "<%= ldap_password %>"
                }
              }
            }
          }
        },
        "jsse" => {
          "classic" => {
             "client-auth" => true,
             "keystore" => {
                        "password" => "<%= keystore_password %>",
                        "url" => "file://<%= keystore_url %>"
                    },
             "truststore" => {
                        "password" => "<%= truststore_password %>",
                        "url" => "file://<%= truststore_url %>"
                    }
            }
         }
      }
    }
  }
}

  
